CREATE TABLE Ventas (                        venta_id INT PRIMARY KEY AUTO_INCREMENT,                        cliente_id INT NOT NULL,                        fecha_venta DATE NOT NULL,                        valor DECIMAL(10, 2) NOT NULL);CREATE TABLE Empleados (                           empleado_id INT PRIMARY KEY AUTO_INCREMENT,                           nombre VARCHAR(100) NOT NULL,                           departamento_id INT NOT NULL,                           fecha_contratacion DATE NOT NULL,                           salario DECIMAL(10, 2) NOT NULL);CREATE TABLE Clientes (                          cliente_id INT PRIMARY KEY AUTO_INCREMENT,                          nombre VARCHAR(100) NOT NULL,                          apellido VARCHAR(100) NOT NULL);CREATE TABLE Departamentos (                               departamento_id INT PRIMARY KEY AUTO_INCREMENT,                               nombre_departamento VARCHAR(100) NOT NULL,                               jefe_id INT DEFAULT NULL);ALTER TABLE Ventas    ADD CONSTRAINT fk_cliente_id FOREIGN KEY (cliente_id) REFERENCES Clientes(cliente_id);ALTER TABLE Empleados    ADD CONSTRAINT fk_departamento_id FOREIGN KEY (departamento_id) REFERENCES        Departamentos(departamento_id);-- Insertar datos en la tabla DepartamentosINSERT INTO Departamentos (nombre_departamento, jefe_id) VALUES                                                             ('Ventas', NULL),                                                             ('Marketing', NULL),                                                             ('TI', NULL),                                                             ('Recursos Humanos', NULL),                                                             ('Finanzas', NULL),                                                             ('Operaciones', NULL),                                                             ('Logística', NULL),                                                             ('Atención al Cliente', NULL),                                                             ('Desarrollo', NULL),                                                             ('Calidad', NULL);-- Insertar datos en la tabla EmpleadosINSERT INTO Empleados (nombre, departamento_id, fecha_contratacion, salario) VALUES                                                                                 ('Juan Pérez', 1, '2020-05-15', 35000.00),                                                                                 ('María García', 2, '2019-03-10', 38000.00),                                                                                 ('Carlos López', 3, '2021-01-20', 42000.00),                                                                                 ('Ana Martínez', 4, '2018-11-05', 36000.00),                                                                                 ('Luis Rodríguez', 5, '2020-07-22', 40000.00),                                                                                 ('Sofía Hernández', 1, '2022-02-14', 32000.00),                                                                                 ('Pedro Díaz', 2, '2021-09-30', 37000.00),                                                                                 ('Elena Ruiz', 3, '2019-06-18', 41000.00),                                                                                 ('Jorge Sánchez', 4, '2020-04-25', 35500.00),                                                                                 ('Mónica Vargas', 5, '2021-12-01', 39000.00);-- Actualizar los jefes de departamentoUPDATE Departamentos SET jefe_id = 1 WHERE departamento_id = 1;UPDATE Departamentos SET jefe_id = 2 WHERE departamento_id = 2;UPDATE Departamentos SET jefe_id = 3 WHERE departamento_id = 3;UPDATE Departamentos SET jefe_id = 4 WHERE departamento_id = 4;UPDATE Departamentos SET jefe_id = 5 WHERE departamento_id = 5;UPDATE Departamentos SET jefe_id = 6 WHERE departamento_id = 6;UPDATE Departamentos SET jefe_id = 7 WHERE departamento_id = 7;UPDATE Departamentos SET jefe_id = 8 WHERE departamento_id = 8;UPDATE Departamentos SET jefe_id = 9 WHERE departamento_id = 9;UPDATE Departamentos SET jefe_id = 10 WHERE departamento_id = 10;-- Insertar datos en la tabla ClientesINSERT INTO Clientes (nombre, apellido) VALUES                                            ('Alejandro', 'Gómez'),                                            ('Beatriz', 'Fernández'),                                            ('César', 'Ramírez'),                                            ('Diana', 'Torres'),                                            ('Ernesto', 'Mendoza'),                                            ('Fabiola', 'Castro'),                                            ('Gabriel', 'Ortega'),                                            ('Hilda', 'Jiménez'),                                            ('Iván', 'Navarro'),                                            ('Jessica', 'Méndez');-- Insertar datos en la tabla VentasINSERT INTO Ventas (cliente_id, fecha_venta, valor) VALUES                                                        (1, '2023-01-05', 1250.50),                                                        (2, '2023-01-12', 850.75),                                                        (3, '2023-01-18', 2200.00),                                                        (4, '2023-02-03', 1750.25),                                                        (5, '2023-02-15', 950.00),                                                        (6, '2023-03-01', 3100.80),                                                        (7, '2023-03-10', 420.50),                                                        (8, '2023-03-22', 1350.90),                                                        (9, '2023-04-05', 2800.75),                                                        (10, '2023-04-18', 1650.30);INSERT INTO Ventas (cliente_id, fecha_venta, valor)VALUES    (1, '2024-06-01', 1500.00),    (2, '2024-06-05', 2000.50),    (2, '2024-06-10', 1750.75),    (2, '2024-06-15', 2200.00),    (2, '2024-06-20', 1950.25),    (6, '2024-06-25', 1800.00),    (4, '2024-06-30', 2100.75),    (8, '2024-07-05', 1600.50),    (9, '2024-07-10', 2300.00),    (10, '2024-07-15', 2500.25);-- Ej 1WITH VentasAltas AS (    SELECT *    FROM Ventas    WHERE valor > 1000)SELECT COUNT(venta_id),AVG(valor)FROM VentasAltas;-- Ej 2WITH PromedioPorDepartamento AS (    SELECT AVG(salario) AS promedio_salario    FROM Empleados    GROUP BY departamento_id)SELECT *FROM PromedioPorDepartamentoWHERE promedio_salario > 40000;-- Ej 3WITH AntiguedadEmpleados AS (    SELECT empleado_id,nombre,DATEDIFF(now(),fecha_contratacion) AS dias_antiguedad    FROM Empleados)SELECT dias_antiguedadFROM AntiguedadEmpleadosWHERE dias_antiguedad > 1825;SELECT DATEDIFF(now(),DAY(2020-04-09));-- Ej 4WITH VentasClientes AS (    SELECT v.venta_id AS venta_id,           c.cliente_id AS cliente_id,           v.fecha_venta AS fecha_venta    FROM Ventas v JOIN Clientes c    ON v.cliente_id = c.cliente_id    ORDER BY fecha_venta)SELECT cliente_id, COUNT(*) AS cantidad_comprasFROM VentasClientesWHERE DATEDIFF(now(),fecha_venta) < 365GROUP BY cliente_idHAVING cantidad_compras > 3;-- Ej 5WITH EmpleadosConMayorSalario AS (    SELECT nombre, salario    FROM Empleados    ORDER BY salario DESC    LIMIT 10)SELECT *FROM EmpleadosConMayorSalario;-- Ej 6WITH VentasPorMes AS (    SELECT YEAR(fecha_venta) AS anio,           MONTH(fecha_venta) AS mes,           SUM(valor) AS total_vendido    FROM ventas    GROUP BY anio,mes    HAVING total_vendido > 5000)SELECT *FROM VentasPorMes;-- Ej 7WITH RECURSIVE JerarquiaDepartamental AS (    SELECT departamento_id,           nombre_departamento,           jefe_id AS id_depto_superior,           1 AS nivel    FROM Departamentos    WHERE jefe_id IS NULL    UNION ALL    SELECT        d.departamento_id,        d.nombre_departamento,        d.jefe_id AS id_depto_superior,        jd.nivel + 1 AS nivel    FROM Departamentos d    JOIN JerarquiaDepartamental jd    ON d.departamento_id = jd.id_depto_superior    WHERE jd.nivel < 10)SELECT *FROM JerarquiaDepartamental;-- Ej 8WITH ClientesDuplicados AS (    SELECT CONCAT(nombre," ", apellido) AS nombre_completo    FROM clientes    GROUP BY nombre_completo    HAVING COUNT(nombre_completo) > 1)SELECT nombre_completo AS nombre_duplicadoFROM ClientesDuplicados;-- Ej 9WITH ClientesQueGastaronMasDe10000 AS (    WITH TotalVentasPorCliente AS (        SELECT CONCAT(c.nombre," ", c.apellido) AS nombre_completo,               c.cliente_id,               SUM(v.valor) AS total_gastado        FROM Clientes c                 JOIN Ventas v                      ON c.cliente_id = v.cliente_id        GROUP BY c.cliente_id    )    SELECT *    FROM TotalVentasPorCliente    WHERE total_gastado > 10000)SELECT *FROM ClientesQueGastaronMasDe10000;-- Ej 10WITH VentasUltimoMes AS (    SELECT *    FROM Ventas    WHERE fecha_venta > DATE_SUB(now(),INTERVAL 30 DAY))SELECT CONCAT(c.nombre," ", c.apellido) AS nombre_completo,    vum.*FROM Clientes cJOIN VentasUltimoMes vumON c.cliente_id = vum.cliente_id;